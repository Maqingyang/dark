"use strict";Object.defineProperty(exports,"__esModule",{value:true});var types_1=require("./types");var errors=require("./errors");const bs58check=require("bs58check");exports.AddressZero="0x0000000000000000000000000000000000000000";exports.HashZero="0x0000000000000000000000000000000000000000000000000000000000000000";function isBigNumber(r){return r instanceof types_1.BigNumber}function addSlice(e){if(e.slice){return e}e.slice=function(){var r=Array.prototype.slice.call(arguments);return new Uint8Array(Array.prototype.slice.apply(e,r))};return e}function isArrayish(r){if(!r||parseInt(String(r.length))!=r.length||typeof r==="string"){return false}for(var e=0;e<r.length;e++){var t=r[e];if(t<0||t>=256||parseInt(String(t))!=t){return false}}return true}exports.isArrayish=isArrayish;function arrayify(r){if(r==null){errors.throwError("cannot convert null value to array",errors.INVALID_ARGUMENT,{arg:"value",value:r})}if(isBigNumber(r)){r=r.toHexString()}if(typeof r==="string"){if(r.indexOf("0x")===-1){const i=bs58check.decode(r.substring(4));r=i.toString("hex").substring(2)}else{r=r.substring(2).toLowerCase()}var e=[];for(var t=0;t<r.length;t+=2){e.push(parseInt(r.substr(t,2),16))}return addSlice(new Uint8Array(e))}if(isArrayish(r)){return addSlice(new Uint8Array(r))}errors.throwError("invalid arrayify value",null,{arg:"value",value:r,type:typeof r});return null}exports.arrayify=arrayify;function concat(e){var t=[];var i=0;for(let r=0;r<e.length;r++){var n=arrayify(e[r]);t.push(n);i+=n.length}var a=new Uint8Array(i);var s=0;for(let r=0;r<t.length;r++){a.set(t[r],s);s+=t[r].length}return addSlice(a)}exports.concat=concat;function stripZeros(r){var e=arrayify(r);if(e.length===0){return e}var t=0;while(e[t]===0){t++}if(t){e=e.slice(t)}return e}exports.stripZeros=stripZeros;function padZeros(r,e){r=arrayify(r);if(e<r.length){throw new Error("cannot pad")}var t=new Uint8Array(e);t.set(r,e-r.length);return addSlice(t)}exports.padZeros=padZeros;function isHexString(r,e){if(typeof r!=="string"||!r.match(/^0x[0-9A-Fa-f]*$/)){return false}if(e&&r.length!==2+2*e){return false}return true}exports.isHexString=isHexString;var HexCharacters="0123456789abcdef";function hexlify(r){if(isBigNumber(r)){return r.toHexString()}if(typeof r==="number"){if(r<0){errors.throwError("cannot hexlify negative value",errors.INVALID_ARGUMENT,{arg:"value",value:r})}var e="";while(r){e=HexCharacters[r&15]+e;r=Math.floor(r/16)}if(e.length){if(e.length%2){e="0"+e}return"0x"+e}return"0x00"}if(typeof r==="string"){var t=r.match(/^(0x)?[0-9a-fA-F]*$/);if(!t){errors.throwError("invalid hexidecimal string",errors.INVALID_ARGUMENT,{arg:"value",value:r})}if(t[1]!=="0x"){errors.throwError("hex string must have 0x prefix",errors.INVALID_ARGUMENT,{arg:"value",value:r})}if(r.length%2){r="0x0"+r.substring(2)}return r}if(isArrayish(r)){var i=[];for(var n=0;n<r.length;n++){var a=r[n];i.push(HexCharacters[(a&240)>>4]+HexCharacters[a&15])}return"0x"+i.join("")}errors.throwError("invalid hexlify value",null,{arg:"value",value:r});return"never"}exports.hexlify=hexlify;function hexDataLength(r){if(!isHexString(r)||r.length%2!==0){return null}return(r.length-2)/2}exports.hexDataLength=hexDataLength;function hexDataSlice(r,e,t){if(!isHexString(r)){errors.throwError("invalid hex data",errors.INVALID_ARGUMENT,{arg:"value",value:r})}if(r.length%2!==0){errors.throwError("hex data length must be even",errors.INVALID_ARGUMENT,{arg:"value",value:r})}e=2+2*e;if(t!=null){return"0x"+r.substring(e,e+2*t)}return"0x"+r.substring(e)}exports.hexDataSlice=hexDataSlice;function hexStripZeros(r){if(!isHexString(r)){errors.throwError("invalid hex string",errors.INVALID_ARGUMENT,{arg:"value",value:r})}while(r.length>3&&r.substring(0,3)==="0x0"){r="0x"+r.substring(3)}return r}exports.hexStripZeros=hexStripZeros;function hexZeroPad(r,e){if(!isHexString(r)){errors.throwError("invalid hex string",errors.INVALID_ARGUMENT,{arg:"value",value:r})}while(r.length<2*e+2){r="0x0"+r.substring(2)}return r}exports.hexZeroPad=hexZeroPad;function isSignature(r){return r&&r.r!=null&&r.s!=null}function splitSignature(r){var e=0;var t="0x",i="0x";if(isSignature(r)){if(r.v==null&&r.recoveryParam==null){errors.throwError("at least on of recoveryParam or v must be specified",errors.INVALID_ARGUMENT,{argument:"signature",value:r})}t=hexZeroPad(r.r,32);i=hexZeroPad(r.s,32);e=r.v;if(typeof e==="string"){e=parseInt(e,16)}var n=r.recoveryParam;if(n==null&&r.v!=null){n=1-e%2}e=27+n}else{var a=arrayify(r);if(a.length!==65){throw new Error("invalid signature")}t=hexlify(a.slice(0,32));i=hexlify(a.slice(32,64));e=a[64];if(e!==27&&e!==28){e=27+e%2}}return{r:t,s:i,recoveryParam:e-27,v:e}}exports.splitSignature=splitSignature;function joinSignature(r){r=splitSignature(r);return hexlify(concat([r.r,r.s,r.recoveryParam?"0x1c":"0x1b"]))}exports.joinSignature=joinSignature;