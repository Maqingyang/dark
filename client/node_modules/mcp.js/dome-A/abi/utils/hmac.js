"use strict";var __importStar=this&&this.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)if(Object.hasOwnProperty.call(r,t))e[t]=r[t];e["default"]=r;return e};Object.defineProperty(exports,"__esModule",{value:true});var crypto_1=require("crypto");var bytes_1=require("./bytes");var errors=__importStar(require("./errors"));var supportedAlgorithms={sha256:true,sha512:true};function computeHmac(r,e,t){if(!supportedAlgorithms[r]){errors.throwError("unsupported algorithm "+r,errors.UNSUPPORTED_OPERATION,{operation:"hmac",algorithm:r})}return bytes_1.arrayify(crypto_1.createHmac(r,new Buffer(bytes_1.arrayify(e))).update(new Buffer(bytes_1.arrayify(t))).digest())}exports.computeHmac=computeHmac;