const convert=require("./convert.js");function utf8ToBytes(n){const o=[];let r=0;for(let t=0;t<n.length;t++){let e=n.charCodeAt(t);if(e<128){o[r++]=e}else if(e<2048){o[r++]=e>>6|192;o[r++]=e&63|128}else if((e&64512)==55296&&t+1<n.length&&(n.charCodeAt(t+1)&64512)==56320){e=65536+((e&1023)<<10)+(n.charCodeAt(++t)&1023);o[r++]=e>>18|240;o[r++]=e>>12&63|128;o[r++]=e>>6&63|128;o[r++]=e&63|128}else{o[r++]=e>>12|224;o[r++]=e>>6&63|128;o[r++]=e&63|128}}return convert.arrayify(o)}function bytesToUtf8(o){o=convert.arrayify(o);let r="";let f=0;while(f<o.length){const i=o[f++];if(i>>7==0){r+=String.fromCharCode(i);continue}if(i>>6==2){continue}let e=null;if(i>>5==6){e=1}else if(i>>4==14){e=2}else if(i>>3==30){e=3}else if(i>>2==62){e=4}else if(i>>1==126){e=5}else{continue}if(f+e>o.length){for(;f<o.length;f++){if(o[f]>>6!=2){break}}if(f!=o.length)continue;return r}let t=i&(1<<8-e-1)-1;let n;for(n=0;n<e;n++){const l=o[f++];if(l>>6!=2){break}t=t<<6|l&63}if(n!=e){f--;continue}if(t<=65535){r+=String.fromCharCode(t);continue}t-=65536;r+=String.fromCharCode((t>>10&1023)+55296,(t&1023)+56320)}return r}module.exports={toUtf8Bytes:utf8ToBytes,toUtf8String:bytesToUtf8};