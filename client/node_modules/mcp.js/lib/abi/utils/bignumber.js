"use strict";var __extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]};return function(e,t){o(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}}();var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)if(Object.hasOwnProperty.call(e,r))t[r]=e[r];t["default"]=e;return t};Object.defineProperty(exports,"__esModule",{value:true});var bn_js_1=__importDefault(require("bn.js"));var bytes_1=require("./bytes");var properties_1=require("./properties");var types_1=require("./types");var errors=__importStar(require("./errors"));var BN_1=new bn_js_1.default.BN(-1);function toHex(e){var t=e.toString(16);if(t[0]==="-"){if(t.length%2===0){return"-0x0"+t.substring(1)}return"-0x"+t.substring(1)}if(t.length%2===1){return"0x0"+t}return"0x"+t}function toBN(e){return bigNumberify(e)._bn}function toBigNumber(e){return new BigNumber(toHex(e))}var BigNumber=function(r){__extends(o,r);function o(e){var t=r.call(this)||this;errors.checkNew(t,o);if(typeof e==="string"){if(bytes_1.isHexString(e)){if(e=="0x"){e="0x0"}properties_1.defineReadOnly(t,"_hex",e)}else if(e[0]==="-"&&bytes_1.isHexString(e.substring(1))){properties_1.defineReadOnly(t,"_hex",e)}else if(e.match(/^-?[0-9]*$/)){if(e==""){e="0"}properties_1.defineReadOnly(t,"_hex",toHex(new bn_js_1.default.BN(e)))}else{errors.throwError("invalid BigNumber string value",errors.INVALID_ARGUMENT,{arg:"value",value:e})}}else if(typeof e==="number"){if(parseInt(String(e))!==e){errors.throwError("underflow",errors.NUMERIC_FAULT,{operation:"setValue",fault:"underflow",value:e,outputValue:parseInt(String(e))})}try{properties_1.defineReadOnly(t,"_hex",toHex(new bn_js_1.default.BN(e)))}catch(e){errors.throwError("overflow",errors.NUMERIC_FAULT,{operation:"setValue",fault:"overflow",details:e.message})}}else if(e instanceof o){properties_1.defineReadOnly(t,"_hex",e._hex)}else if(e.toHexString){properties_1.defineReadOnly(t,"_hex",toHex(toBN(e.toHexString())))}else if(bytes_1.isArrayish(e)){properties_1.defineReadOnly(t,"_hex",toHex(new bn_js_1.default.BN(bytes_1.hexlify(e).substring(2),16)))}else{errors.throwError("invalid BigNumber value",errors.INVALID_ARGUMENT,{arg:"value",value:e})}return t}Object.defineProperty(o.prototype,"_bn",{get:function(){if(this._hex[0]==="-"){return new bn_js_1.default.BN(this._hex.substring(3),16).mul(BN_1)}return new bn_js_1.default.BN(this._hex.substring(2),16)},enumerable:true,configurable:true});o.prototype.fromTwos=function(e){return toBigNumber(this._bn.fromTwos(e))};o.prototype.toTwos=function(e){return toBigNumber(this._bn.toTwos(e))};o.prototype.add=function(e){return toBigNumber(this._bn.add(toBN(e)))};o.prototype.sub=function(e){return toBigNumber(this._bn.sub(toBN(e)))};o.prototype.div=function(e){var t=bigNumberify(e);if(t.isZero()){errors.throwError("division by zero",errors.NUMERIC_FAULT,{operation:"divide",fault:"division by zero"})}return toBigNumber(this._bn.div(toBN(e)))};o.prototype.mul=function(e){return toBigNumber(this._bn.mul(toBN(e)))};o.prototype.mod=function(e){return toBigNumber(this._bn.mod(toBN(e)))};o.prototype.pow=function(e){return toBigNumber(this._bn.pow(toBN(e)))};o.prototype.maskn=function(e){return toBigNumber(this._bn.maskn(e))};o.prototype.eq=function(e){return this._bn.eq(toBN(e))};o.prototype.lt=function(e){return this._bn.lt(toBN(e))};o.prototype.lte=function(e){return this._bn.lte(toBN(e))};o.prototype.gt=function(e){return this._bn.gt(toBN(e))};o.prototype.gte=function(e){return this._bn.gte(toBN(e))};o.prototype.isZero=function(){return this._bn.isZero()};o.prototype.toNumber=function(){try{return this._bn.toNumber()}catch(e){errors.throwError("overflow",errors.NUMERIC_FAULT,{operation:"setValue",fault:"overflow",details:e.message})}return null};o.prototype.toString=function(){return this._bn.toString(10)};o.prototype.toHexString=function(){return this._hex};return o}(types_1.BigNumber);function bigNumberify(e){if(e instanceof BigNumber){return e}return new BigNumber(e)}exports.bigNumberify=bigNumberify;exports.ConstantNegativeOne=bigNumberify(-1);exports.ConstantZero=bigNumberify(0);exports.ConstantOne=bigNumberify(1);exports.ConstantTwo=bigNumberify(2);exports.ConstantWeiPerEther=bigNumberify("1000000000000000000");